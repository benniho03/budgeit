<mat-toolbar style="margin-bottom: 0.5em" color="primary">
  <span>Total Expenses: {{ totalExpenses.toFixed(2) }} €</span>
</mat-toolbar>
<mat-form-field style="margin: 0 10px">
  <mat-label>Amount</mat-label>
  <input matInput #count [formControl]="numberFormControl" />
  <mat-error *ngIf="numberFormControl.invalid"
    >Please enter a valid number.</mat-error
  >
</mat-form-field>
<mat-form-field style="margin: 0 10px">
  <mat-label>Name</mat-label>
  <input matInput type="text" #name [formControl]="nameFormControl" />
  <mat-error *ngIf="nameFormControl.invalid"
    >Please enter a valid name.</mat-error
  >
</mat-form-field>
<mat-form-field style="margin: 0 10px">
  <mat-label>Price</mat-label>
  <input matInput type="text" #price [formControl]="priceFormControl" />
  <mat-error *ngIf="priceFormControl.invalid"
    >Please enter a valid price.</mat-error
  >
</mat-form-field>
<mat-form-field appearance="fill">
  <mat-label>Category</mat-label>
  <mat-select #category>
    <mat-option [value]="">None</mat-option>
    <mat-option *ngFor="let category of categories" [value]="category.name">
      {{ category.name }}
    </mat-option>
  </mat-select>
</mat-form-field>

<button
  mat-fab
  color="basic"
  (click)="
    numberFormControl.valid && nameFormControl.valid && priceFormControl.valid
      ? add(name.value, +count.value, +price.value, category.value)
      : ''
  "
  type="submit"
>
  <mat-icon
    aria-hidden="false"
    aria-label="Add Purchase"
    fontIcon="add"
  ></mat-icon>
</button>
<button mat-fab color="primary" (click)="sync()">
  <mat-icon
    aria-hidden="false"
    aria-label="Synchronize"
    fontIcon="sync"
  ></mat-icon>
</button>
<br />
<mat-form-field style="margin: 0 10px">
  <mat-label>Search</mat-label>
  <input matInput type="text" [(ngModel)]="searchText" />
</mat-form-field>
<div class="example-list" cdkDropList (cdkDropListDropped)="drop($event)">
  <mat-card
    class="example-box"
    cdkDrag
    *ngFor="let purchase of purchases | filter : searchText"
  >
    <div class="px-3 flex justify-between items-center">
      <div class="flex-col">
        <span class="text-gray-600">{{ formatDate(purchase.createdAt!) }}</span>

        <div class="">
          <span class="text-xl text-gray-700">{{ purchase.count }}x </span>
          <span class="text-3xl font-bold uppercase">{{ purchase.name }}</span>
        </div>

        <span class="font-bold text-xl" [style.color]="purchase.category.color">{{
          purchase.category ? purchase.category.name : ""
        }}</span>
      </div>

      <span class="text-2xl font-bold">{{ purchase.price.toFixed(2) + "€" }}</span>

      <div class="flex gap-2">
        <button
          mat-mini-fab
          color="primary"
          (click)="
            openDialog(
              purchase.id,
              purchase.name,
              purchase.count,
              purchase.price
            )
          "
        >
          <mat-icon
            aria-hidden="false"
            aria-label="Edit"
            fontIcon="edit"
          ></mat-icon>
        </button>
        <button mat-mini-fab color="warn" (click)="delete(purchase.id)">
          <mat-icon
            aria-hidden="false"
            aria-label="Delete"
            fontIcon="delete"
          ></mat-icon>
        </button>
      </div>
    </div>
  </mat-card>
</div>
