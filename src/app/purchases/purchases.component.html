<mat-toolbar class="mb-2 justify-center" color="primary">
  <span>Total Expenses: {{ totalExpenses.toFixed(2) }} €</span>
</mat-toolbar>
<div class="flex flex-col justify-around md:flex-row md:gap-3 md:justify-start">

  <mat-form-field class="w-10/12 mx-auto">
    <mat-label>Name</mat-label>
    <input matInput type="text" #name [formControl]="requiredFormControl" />
    <mat-icon matSuffix>text_format</mat-icon>
    <mat-error *ngIf="requiredFormControl.invalid"
      >Please enter a valid name.</mat-error
    >
  </mat-form-field>
  <mat-form-field class="w-10/12 mx-auto">
    <mat-label>Price</mat-label>
    <input matInput type="text" #price [formControl]="priceFormControl" />
    <mat-icon matSuffix>attach_money</mat-icon>
    <mat-error *ngIf="priceFormControl.invalid"
      >Please enter a valid price.</mat-error
    >
  </mat-form-field>
  <mat-form-field class="w-10/12 mx-auto">
    <mat-label>Amount</mat-label>
    <input type="text" matInput #count [formControl]="numberFormControl" />
    <mat-icon matSuffix>shopping_cart</mat-icon>
    <mat-error *ngIf="numberFormControl.invalid"
      >Please enter a valid number.</mat-error
    >
  </mat-form-field>
  <mat-form-field class="w-10/12 mx-auto">
    <mat-label>Category</mat-label>
    <mat-select #category [formControl]="requiredFormControl">
      <mat-option *ngFor="let category of categories" [value]="category.name">
        {{ category.name }}
      </mat-option>
    </mat-select>
  </mat-form-field>
</div>
<div class="w-12/12 flex mb-5 justify-center">
  <button
    color="primary"
    mat-fab
    (click)="
      numberFormControl.valid && requiredFormControl.valid && priceFormControl.valid
        ? add(name.value, +count.value, +price.value, category.value)
        : ''
    "
    type="submit"
  >
    <mat-icon
      aria-hidden="false"
      aria-label="Add Purchase"
    >add_shopping_cart</mat-icon>
  </button>
</div>
<div class="flex justify-center w-10/12 md:w-6/12 mx-auto">
  <mat-form-field class="w-full">
    <mat-label>Search</mat-label>
    <input matInput type="text" [(ngModel)]="searchText" />
    <mat-icon matSuffix>search</mat-icon>
  </mat-form-field>
</div>
<div class="example-list flex flex-col items-center w-10/12 mx-auto md:w-6/12" cdkDropList (cdkDropListDropped)="drop($event)">
  <mat-card
    class="w-full example-box"
    cdkDrag
    *ngFor="let purchase of purchases | filter : searchText"
  >
    <div class="px-3 flex justify-between items-center">
      <div class="flex-col">
        <span class="text-gray-600">{{ formatDate(purchase.createdAt!) }}</span>

        <div class="">
          <span class="text-xl text-gray-700">{{ purchase.count }}x </span>
          <span class="text-3xl font-bold uppercase">{{ purchase.name }}</span>
        </div>

        <span
          class="font-bold text-lg"
          [style.color]="purchase.category.color"
          >{{ purchase.category ? purchase.category.name : "" }}</span
        >
      </div>

      <span class="text-2xl font-bold">{{
        purchase.price.toFixed(2) + "€"
      }}</span>

      <div class="flex gap-2">
        <button
          mat-mini-fab
          color="primary"
          (click)="
            openDialog(
              purchase.id,
              purchase.name,
              purchase.count,
              purchase.price
            )
          "
        >
          <mat-icon
            aria-hidden="false"
            aria-label="Edit"
            fontIcon="edit"
          ></mat-icon>
        </button>
        <button mat-mini-fab color="warn" (click)="delete(purchase.id)">
          <mat-icon
            aria-hidden="false"
            aria-label="Delete"
            fontIcon="delete"
          ></mat-icon>
        </button>
      </div>
    </div>
  </mat-card>
</div>
